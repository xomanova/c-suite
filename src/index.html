<html>
<head>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.7.16.min.jw"></script>
    <script src="js/aws-cognito-sdk.min.js"></script>
    <script src="js/amazon-cognito-identity.min.js"></script>
    <script>

var idToken = null;

function checkLogin() {
    var url_string = window.location.href;
    var url = new URL(url_string);
    idToken = url.searchParams.get("id_token");
    if (idToken != null) {
        document.getElementById("welcomeMsg").innerHTML = "signed in";
        auth();
    }
}

function auth() {
    AWS.config.update({
      region: "us-east-1",
    });

    AWS.config.credentials = new AWS.CognitoIdentityCredentials({
            IdentityPoolId : '(IDENTITY POOL ID)',
            Logins : {
              "cognito-idp.(AWS_REGION).amazonaws.com/(POOL_ID)": idToken
            }
          });
}

function insertItem() {
    var docClient = new AWS.DynamoDB.DocumentClient();

    var params = {
        TableName :"Person",
        Item:{
            "FirstName": "John", // Partition Key
            "LastName": "Smith", // Sort Key
            "info": {
                "FavoriteColor": "blue",
                "YearOfBirth": 1942
            }
        }
    };
    docClient.put(params, function(err, data) {
        if (err) {
            document.getElementById('textarea').innerHTML = "Unable to add item: " + "\n" + JSON.stringify(err, undefined, 2);
        } else {
            document.getElementById('textarea').innerHTML = "PutItem succeeded: " + "\n" + JSON.stringify(data, undefined, 2);
        }
    });
}

function readItem() {

    var docClient = new AWS.DynamoDB.DocumentClient();

    var params = {
        TableName: "Person",
        Key:{
            "FirstName": "John",// Partition Key
            "LastName": "Smith" // Sort/Range Key
        }
    };
    docClient.get(params, function(err, data) {
        if (err) {
            document.getElementById('textarea').innerHTML = "Unable to read item: " + "\n" + JSON.stringify(err, undefined, 2);
        } else {
            document.getElementById('textarea').innerHTML = "GetItem succeeded: " + "\n" + JSON.stringify(data, undefined, 2);
        }
    });
}
</script>
</head>

<body onload="checkLogin()">
<div id="welcomeMsg"></div> <br>

<a href="https://login.megrehn.com/login?client_id=7aluf3oo5bq9bradlnrurppusq&response_type=token&scope=aws.cognito.signin.user.admin+email+openid+phone+profile&redirect_uri=https://potential-guacamole.megrehn.com">Login</a>

<br><br>

<input type="button" value="Insert Item" onlick="insertItem();" />
<input type="button" value="Read Item" onlick="readItem();" />
<br><br>

<textarea readonly id="textarea" style="width:400px; height:600px"></textarea>

</body>
</html>